<!DOCTYPE html>
<html>
<body>
    <div id="chatbox" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
        <p><strong>ELIZA:</strong> How do you do. Please tell me your problem.</p>
    </div>
    <input type="text" id="userInput" placeholder="Type here..." style="width: 80%;">
    <button onclick="sendMessage()">Send</button>

    <script>
        // Insert the 'eliza' object code from above here...


        const eliza = {
    // Words to flip when mirroring the user
    reflections: {
        "am": "are",
        "was": "were",
        "i": "you",
        "i'm": "you are",
        "my": "your",
        "are": "am",
        "you're": "i am",
        "your": "my",
        "yours": "mine",
        "me": "you"
    },

    // Pattern-Response pairs
    scripts: [
        [/(.*) (?:hello|hi|hey)(.*)/i, ["Hello! How are you feeling today?", "Hi there. What's on your mind?"]],
        [/(.*) feel (.*)/i, ["Why do you feel $2?", "Does feeling $2 happen often?"]],
        [/(.*) mother(.*)/i, ["Tell me more about your mother.", "What was your relationship like?"]],
        [/(.*) (?:can't|cannot) (.*)/i, ["How do you know you can't $2?", "What if you could $2?"]],
        [/(.*) (?:stressed|anxious|sad)(.*)/i, ["I'm sorry to hear that. What is making you feel that way?", "How do you cope with those feelings?"]],
        [/(.*) (?:yes|yeah|yep)(.*)/i, ["You seem quite sure.", "Can you elaborate on that?"]],
        [/(.*)/i, ["Tell me more.", "I see. And how does that make you feel?", "Why do you say that?"]]
    ],

    reflect: function(text) {
        return text.toLowerCase().split(/\s+/).map(word => {
            return this.reflections[word] || word;
        }).join(" ");
    },

    getResponse: function(input) {
        for (let [pattern, responses] of this.scripts) {
            let match = input.match(pattern);
            if (match) {
                // Pick a random response from the matches
                let response = responses[Math.floor(Math.random() * responses.length)];
                
                // If there's a captured group (the mirror part), reflect it
                if (match.length > 1 && response.includes("$2")) {
                    let captured = this.reflect(match[2]);
                    response = response.replace("$2", captured);
                }
                return response;
            }
        }
    }
};

// Example Usage:
// console.log(eliza.getResponse("I feel tired")); 
// Outputs: "Why do you feel tired?"

        function sendMessage() {
            const inputField = document.getElementById('userInput');
            const chatbox = document.getElementById('chatbox');
            const userText = inputField.value;

            if (userText.trim() === "") return;

            // Display User Message
            chatbox.innerHTML += `<p><strong>You:</strong> ${userText}</p>`;
            
            // Get and Display ELIZA response
            const response = eliza.getResponse(userText);
            setTimeout(() => {
                chatbox.innerHTML += `<p><strong>ELIZA:</strong> ${response}</p>`;
                chatbox.scrollTop = chatbox.scrollHeight;
            }, 500);

            inputField.value = "";
        }
    </script>
</body>
</html>
